

## RabbitMQ
* RabbitMQ 丢失数据的情况？
    - 生产者端。消息因为网络问题丢失或者发送到RabbitMQ的时候出错
    - rabbitMQ服务器未做持久化
    - 消费者端。打开了autoAck。未完成消费之前就自动回复了。

* RabbitMQ 丢失数据怎样解决？
    - 生产者端：通过confirm模式异步确认消息是否发送成功。在失败的回调函数中处理发送失败的逻辑
    - rabbitMQ端： 打开持久化机制。
        - 建立 queue 的时候，持久化queue
        - 生产者发消息的时候，deliverMode=2，让MQ将消息也持久化
        - 极端情况下，内存的数据未来得及持久化，也会丢失
    - 消费者端： 去掉自动AutoACK，消费逻辑处理结束之后手动提交ACK。

## Kafka
* Kafka 丢失数据的情况？
    - 生产者端：如果确认写成功，也没有重发会丢失。
    - 服务端：如果没有来的及和节点同步就宕机，则这部分数据丢失
    - 消费者端：如果自动提交offset会造成数据丢失

* Kafka 丢失数据怎样解决？
    - 生产者端：设置参数，每个从节点都写成功后才任务成功，如果发送失败，重试次数要设置一个很大的值
    - 服务端：设置参数，要求从节点起码大于1，至少有一个能够被感知到
    - 消费者端：取消自动回复。强一致的保证消息不丢失，会影响到吞吐量